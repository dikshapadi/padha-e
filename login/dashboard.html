<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Data Page</title>
    <script src="https://www.gstatic.com/firebasejs/9.3.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.3.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.3.0/firebase-database-compat.js"></script>
</head>

<body>
    <h1>Your dashboard</h1>
    <div id="userData"></div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBD6ZsOT1P4lPZbQ0HVYHZrPGvaPk274ds",
            authDomain: "sih-e-f67f9.firebaseapp.com",
            databaseURL: "https://sih-e-f67f9-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "sih-e-f67f9",
            storageBucket: "sih-e-f67f9.appspot.com",
            messagingSenderId: "113038032158",
            appId: "1:113038032158:web:6b01cde8843a62e8841d0f",
            measurementId: "G-FWVHBTC79W"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const auth = app.auth();
        const database = app.database();

        const userDataDiv = document.getElementById("userData");

        // Check if a user is authenticated
        const user = auth.currentUser;
        auth.onAuthStateChanged((user) => {

            if (user) {
                const userId = user.uid;
                console.log(userId);


                const userRef = database.ref('users/' + userId);


                userRef.on('value', (snapshot) => {

                    if (snapshot.exists()) {
                        const userData = snapshot.val();

                        // Display the user's data on the page
                        userDataDiv.innerHTML = `
                        <p>Name: ${userData.name}</p>
                        <p>Age: ${userData.age}</p>
                        <p>Phone Number: ${userData.phoneNumber}</p>
                        <p>Gender: ${userData.gender}</p>
                        <p>Class: ${userData.class}</p>
                        <p>You are: ${userData.youAre}</p>
                        <p>Address: ${userData.address}</p>
                        <p>State: ${userData.state}</p>
                    `;
                    } else {
                        userDataDiv.innerHTML = "No data available for this user.";
                    }
                });
            } else {
                // Handle the case when there is no authenticated user
                userDataDiv.innerHTML = "No authenticated user. Please log in or register.";
            }
        });
    </script>
</body>

</html>